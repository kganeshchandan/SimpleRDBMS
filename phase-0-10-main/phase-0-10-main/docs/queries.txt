LOAD EMPLOYEE
LOAD WORKS_ON

Q1_GREATER <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn FROM Q1_GREATER
CLEAR Q1_GREATER

Q2_CROSS <- CROSS EMPLOYEE EMPLOYEE
Q2_CROSS_PAIRS <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2_CROSS
Q2_CROSS_PAIRS_DATE <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2_CROSS_PAIRS
Q2 <- PROJECT EMPLOYEE1_Ssn , EMPLOYEE1_Super_ssn FROM Q2_CROSS_PAIRS_DATE
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
CLEAR Q2_CROSS
CLEAR Q2_CROSS_PAIRS
CLEAR Q2_CROSS_PAIRS_DATE

Q3_CROSS <- CROSS EMPLOYEE WORKS_ON
Q3_CROSS_PROPER <- SELECT Ssn == Essn FROM Q3_CROSS
Q3_FULL_CROSS <- CROSS Q3_CROSS_PROPER Q3_CROSS_PROPER
Q3_PAIRS <- SELECT Q3_CROSS_PROPER1_Sex != Q3_CROSS_PROPER2_Sex FROM Q3_FULL_CROSS
Q3_PROJS <- SELECT Q3_CROSS_PROPER1_Pno == Q3_CROSS_PROPER2_Pno FROM Q3_PAIRS
Q3 <- PROJECT Q3_CROSS_PROPER1_Pno FROM Q3_PROJS
RENAME Q3_CROSS_PROPER1_Pno TO Pno FROM Q3
CLEAR Q3_CROSS
CLEAR Q3_CROSS_PROPER
CLEAR Q3_FULL_CROSS
CLEAR Q3_PAIRS
CLEAR Q3_PROJS

Q4_CROSS <- CROSS EMPLOYEE WORKS_ON
Q4_CROSS_PROPER <- SELECT Ssn == Essn FROM Q4_CROSS
Q4_FULL_CROSS <- CROSS Q4_CROSS_PROPER Q4_CROSS_PROPER
Q4_PAIRS <- SELECT Q4_CROSS_PROPER1_Super_ssn == Q4_CROSS_PROPER2_Ssn FROM Q4_FULL_CROSS
Q4_PROJS <- SELECT Q4_CROSS_PROPER1_Pno == Q4_CROSS_PROPER2_Pno FROM Q4_PAIRS
Q4 <- PROJECT Q4_CROSS_PROPER1_Pno, Q4_CROSS_PROPER1_Ssn, Q4_CROSS_PROPER1_Super_ssn FROM Q4_PROJS
RENAME Q4_CROSS_PROPER1_Pno TO Pno FROM Q4
RENAME Q4_CROSS_PROPER1_Ssn TO Ssn FROM Q4
RENAME Q4_CROSS_PROPER1_Super_ssn TO Super_ssn FROM Q4
CLEAR Q4_CROSS
CLEAR Q4_CROSS_PROPER
CLEAR Q4_FULL_CROSS
CLEAR Q4_PAIRS
CLEAR Q4_PROJS


EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4

QUIT